% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/xl_crosstab.R
\name{xl_crosstab}
\alias{xl_crosstab}
\title{Create Stata-style Cross-Tabulations for Export to Excel}
\usage{
xl_crosstab(
  data,
  row_var,
  col_var,
  strat_var = NULL,
  w_var = NULL,
  row_label = NULL,
  col_label = NULL,
  strat_label = NULL,
  add_total_row = TRUE,
  add_total_col = TRUE,
  show_n = TRUE,
  show_row_pct = TRUE,
  show_col_pct = TRUE,
  show_tot_pct = TRUE,
  show_na = FALSE,
  na_label = "Missing"
)
}
\arguments{
\item{data}{A data frame.}

\item{row_var}{The variable to use for rows (unquoted).}

\item{col_var}{The variable to use for columns (unquoted).}

\item{strat_var}{Optional. Variable to stratify by (3-way table) (unquoted). Default is NULL.}

\item{w_var}{Optional. Variable for weights (unquoted). Default is NULL.}

\item{row_label}{Optional String. Manually set the display name for the row variable.}

\item{col_label}{Optional String. Manually set the display name for the column variable.}

\item{strat_label}{Optional String. Manually set the display name for the stratification variable.}

\item{add_total_row}{Logical. Add a "Total" row at the bottom? Default TRUE.}

\item{add_total_col}{Logical. Add a "Total" column at the right? Default TRUE.}

\item{show_n}{Logical. Show counts? Default TRUE.}

\item{show_row_pct}{Logical. Show row percentages? Default TRUE.}

\item{show_col_pct}{Logical. Show column percentages? Default TRUE.}

\item{show_tot_pct}{Logical. Show total percentages? Default TRUE.}

\item{show_na}{Logical. If TRUE, missing values in row/col variables are shown as an explicit category. Default FALSE.}

\item{na_label}{String. Label for missing values. Default "Missing".}
}
\value{
A data frame in wide format, ready for export to Excel.
}
\description{
Generates a data frame representing a cross-tabulation, with cell content
stacked into a single string for easy export to Excel workbooks.
}
\details{
This function mimics the visual layout of Stata tables. It handles 2-way and
3-way tables, supports weights and missing values, and allows fully
customisable output. You can toggle row/column totals, as well as the
visibility of counts, row percentages, column percentages, and total percentages.
It automatically detects variable labels (e.g. from haven/sjlabelled) if present.
}
\examples{
# 1. Create dummy data
df <- data.frame(
  edu = c("High", "Low", "High", "Low", "High"),
  job = c("Yes", "No", "Yes", "Yes", "No"),
  weight = c(1, 1.2, 0.8, 1, 1)
)

# 2. Simple crosstab
xl_crosstab(df, edu, job)

# 3. Weighted crosstab with custom labels
xl_crosstab(df, edu, job, w_var = weight,
  row_label = "Education", col_label = "Employed")
}
