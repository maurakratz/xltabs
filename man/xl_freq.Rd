% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/xl_freq.R
\name{xl_freq}
\alias{xl_freq}
\title{Create Stata-style Frequency Tables for Excel Export}
\usage{
xl_freq(
  data,
  var,
  w_var = NULL,
  label = NULL,
  show_n = TRUE,
  show_pct = TRUE,
  show_na = FALSE,
  na_label = "Missing",
  add_total = TRUE
)
}
\arguments{
\item{data}{A data frame.}

\item{var}{The variable to analyze (unquoted).}

\item{w_var}{Optional. Variable for weights (unquoted). Default is NULL.}

\item{label}{Optional String. Manually set the display name for the variable.}

\item{show_n}{Logical. Show counts? Default TRUE.}

\item{show_pct}{Logical. Show percentages? Default TRUE.}

\item{show_na}{Logical. If TRUE, missing values are shown as explicit category. Default FALSE.}

\item{na_label}{String. Label for missing values. Default "Missing".}

\item{add_total}{Logical. Add a "Total" row at the bottom? Default TRUE.}
}
\value{
A data frame with two columns: The category and the formatted stats.
}
\description{
Generates a data frame representing a frequency table with counts and percentages,
formatted as a single string per cell for easy export.
Includes support for weights, missing values, and a total row.
Automatically detects variable labels (e.g. from haven).
}
\examples{
# 1. Create dummy data
df <- data.frame(
  region = c("North", "South", "North", "North", "South", NA),
  weight = c(1, 1, 0.5, 1, 1.5, 1)
)

# 2. Basic frequency
xl_freq(df, region)

# 3. With weights and explicit missing category
xl_freq(df, region, w_var = weight, show_na = TRUE, label = "Region")
}
